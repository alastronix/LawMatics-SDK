{'role': 'assistant', 'content': '\nNow let me create tests for PaymentsClient.\n\n\n\n<function_calls>\n<create-file file_path="./LawMatics.SDK.Tests/Clients/PaymentsClientTests.cs">\nusing System;\nusing System.Net;\nusing System.Net.Http;\nusing System.Text.Json;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing LawMatics.SDK.Authentication;\nusing LawMatics.SDK.Clients;\nusing LawMatics.SDK.Configuration;\nusing LawMatics.SDK.Models;\nusing Microsoft.Extensions.Logging;\nusing Moq;\nusing Moq.Protected;\nusing Xunit;\n\nnamespace LawMatics.SDK.Tests.Clients\n{\n    /// <summary>\n    /// Unit tests for the <see cref="PaymentsClient"/> class.\n    /// </summary>\n    public class PaymentsClientTests : IDisposable\n    {\n        private readonly Mock<HttpMessageHandler> _mockHttpMessageHandler;\n        private readonly Mock<ILogger<PaymentsClient>> _mockLogger;\n        private readonly LawMaticsClientOptions _options;\n        private readonly LawMaticsCredentials _credentials;\n        private readonly HttpClient _httpClient;\n        private readonly PaymentsClient _client;\n\n        public PaymentsClientTests()\n        {\n            _mockHttpMessageHandler = new Mock<HttpMessageHandler>();\n            _mockLogger = new Mock<ILogger<PaymentsClient>>();\n            _options = new LawMaticsClientOptions\n            {\n                BaseUrl = "https://api.test.lawmatics.com",\n                ApiVersion = "v1",\n                TimeoutSeconds = 30\n            };\n            _credentials = new LawMaticsCredentials("test-access-token");\n            _httpClient = new HttpClient(_mockHttpMessageHandler.Object);\n            _client = new PaymentsClient(_httpClient, _options, _mockLogger.Object);\n        }\n\n        [Fact]\n        public async Task GetPaymentsAsync_WithValidResponse_ReturnsPayments()\n        {\n            // Arrange\n            var expectedResponse = new PagedResponse<Payment>\n            {\n                Data = new List<Payment>\n                {\n                    new Payment { Id = 1, Amount = 100.00m, Status = "Paid", Type = "Invoice" },\n                    new Payment { Id = 2, Amount = 250.50m, Status = "Pending", Type = "Payment" }\n                },\n                Pagination = new PaginationInfo { Page = 1, PageSize = 10, TotalCount = 2 }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.GetPaymentsAsync();\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(2, result.Data.Count);\n            Assert.Equal(100.00m, result.Data[0].Amount);\n            Assert.Equal("Paid", result.Data[0].Status);\n            Assert.Equal("Invoice", result.Data[0].Type);\n        }\n\n        [Fact]\n        public async Task GetPaymentAsync_WithValidId_ReturnsPayment()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<Payment>\n            {\n                Data = new Payment { Id = 1, Amount = 100.00m, Status = "Paid", Type = "Invoice" }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.GetPaymentAsync(1);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(1, result.Data.Id);\n            Assert.Equal(100.00m, result.Data.Amount);\n            Assert.Equal("Paid", result.Data.Status);\n            Assert.Equal("Invoice", result.Data.Type);\n        }\n\n        [Fact]\n        public async Task CreateInvoiceAsync_WithValidRequest_ReturnsCreatedInvoice()\n        {\n            // Arrange\n            var request = new CreateInvoiceRequest\n            {\n                ContactId = 1,\n                Amount = 500.00m,\n                DueDate = DateTime.UtcNow.AddDays(30),\n                Description = "Test Invoice",\n                Items = new List<InvoiceItem>\n                {\n                    new InvoiceItem { Description = "Service 1", Amount = 300.00m, Quantity = 1 },\n                    new InvoiceItem { Description = "Service 2", Amount = 200.00m, Quantity = 2 }\n                }\n            };\n            var expectedResponse = new ApiResponse<Payment>\n            {\n                Data = new Payment \n                { \n                    Id = 1, \n                    ContactId = request.ContactId,\n                    Amount = request.Amount,\n                    DueDate = request.DueDate,\n                    Description = request.Description,\n                    Status = "Draft",\n                    Type = "Invoice"\n                }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.Created)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.CreateInvoiceAsync(request);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(1, result.Data.Id);\n            Assert.Equal(request.ContactId, result.Data.ContactId);\n            Assert.Equal(request.Amount, result.Data.Amount);\n            Assert.Equal(request.Description, result.Data.Description);\n            Assert.Equal("Draft", result.Data.Status);\n            Assert.Equal("Invoice", result.Data.Type);\n        }\n\n        [Fact]\n        public async Task UpdatePaymentAsync_WithValidRequest_ReturnsUpdatedPayment()\n        {\n            // Arrange\n            var request = new UpdatePaymentRequest\n            {\n                Amount = 600.00m,\n                DueDate = DateTime.UtcNow.AddDays(60),\n                Description = "Updated Invoice"\n            };\n            var expectedResponse = new ApiResponse<Payment>\n            {\n                Data = new Payment \n                { \n                    Id = 1, \n                    Amount = request.Amount,\n                    DueDate = request.DueDate,\n                    Description = request.Description\n                }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.UpdatePaymentAsync(1, request);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(1, result.Data.Id);\n            Assert.Equal(request.Amount, result.Data.Amount);\n            Assert.Equal(request.DueDate, result.Data.DueDate);\n            Assert.Equal(request.Description, result.Data.Description);\n        }\n\n        [Fact]\n        public async Task DeletePaymentAsync_WithValidId_ReturnsSuccessResponse()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<object> { Data = null };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.NoContent)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.DeletePaymentAsync(1);\n\n            // Assert\n            Assert.NotNull(result);\n        }\n\n        [Fact]\n        public async Task ProcessPaymentAsync_WithValidRequest_ReturnsProcessedPayment()\n        {\n            // Arrange\n            var request = new ProcessPaymentRequest\n            {\n                PaymentId = 1,\n                Amount = 100.00m,\n                PaymentMethod = "Credit Card",\n                TransactionId = "txn_123456"\n            };\n            var expectedResponse = new ApiResponse<Payment>\n            {\n                Data = new Payment \n                { \n                    Id = request.PaymentId,\n                    Amount = request.Amount,\n                    Status = "Paid",\n                    PaidDate = DateTime.UtcNow,\n                    PaymentMethod = request.PaymentMethod,\n                    TransactionId = request.TransactionId\n                }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.ProcessPaymentAsync(request);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(request.PaymentId, result.Data.Id);\n            Assert.Equal(request.Amount, result.Data.Amount);\n            Assert.Equal("Paid", result.Data.Status);\n            Assert.Equal(request.PaymentMethod, result.Data.PaymentMethod);\n            Assert.Equal(request.TransactionId, result.Data.TransactionId);\n        }\n\n        [Fact]\n        public async Task GetPaymentsByContactAsync_WithContactId_ReturnsContactPayments()\n        {\n            // Arrange\n            var contactId = 1;\n            var expectedResponse = new PagedResponse<Payment>\n            {\n                Data = new List<Payment>\n                {\n                    new Payment { Id = 1, ContactId = contactId, Amount = 100.00m, Status = "Paid" },\n                    new Payment { Id = 2, ContactId = contactId, Amount = 250.00m, Status = "Pending" }\n                },\n                Pagination = new PaginationInfo { Page = 1, PageSize = 10, TotalCount = 2 }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.GetPaymentsByContactAsync(contactId);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(2, result.Data.Count);\n            Assert.All(result.Data, payment => Assert.Equal(contactId, payment.ContactId));\n        }\n\n        [Fact]\n        public async Task GetPaymentsByStatusAsync_WithStatus_ReturnsFilteredPayments()\n        {\n            // Arrange\n            var status = "Paid";\n            var expectedResponse = new PagedResponse<Payment>\n            {\n                Data = new List<Payment>\n                {\n                    new Payment { Id = 1, Amount = 100.00m, Status = "Paid" },\n                    new Payment { Id = 2, Amount = 250.00m, Status = "Paid" }\n                },\n                Pagination = new PaginationInfo { Page = 1, PageSize = 10, TotalCount = 2 }\n            };\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, System.Text.Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.IsAny<HttpRequestMessage>(),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _client.GetPaymentsByStatusAsync(status);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(2, result.Data.Count);\n            Assert.All(result.Data, payment => Assert.Equal(status, payment.Status));\n        }\n\n        public void Dispose()\n        {\n            _httpClient?.Dispose();\n            _client?.Dispose();\n        }\n    }\n}\n</create-file>\n</function_calls>'}
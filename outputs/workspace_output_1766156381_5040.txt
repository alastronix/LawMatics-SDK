using LawMatics.SDK.Configuration;
using LawMatics.SDK.Exceptions;
using LawMatics.SDK.Models;
using Microsoft.Extensions.Logging;

namespace LawMatics.SDK.Clients
{
    /// <summary>
    /// Client for managing companies in the Lawmatics API
    /// </summary>
    public class CompaniesClient : BaseClient
    {
        public CompaniesClient(HttpClient httpClient, LawMaticsClientOptions options, ILogger? logger = null)
            : base(httpClient, options, logger)
        {
        }

        /// <summary>
        /// Get all companies with optional filtering and pagination
        /// </summary>
        /// <param name="parameters">Optional filter parameters</param>
        /// <returns>Paginated list of companies</returns>
        public async Task<ApiResponse<List<Company>>> GetCompaniesAsync(FilterParameters? parameters = null)
        {
            var queryParams = BuildQueryString(parameters ?? new FilterParameters());
            var response = await GetAsync<List<Company>>($"/companies?{queryParams}");
            return response;
        }

        /// <summary>
        /// Get a specific company by ID
        /// </summary>
        /// <param name="id">Company ID</param>
        /// <returns>Company details</returns>
        public async Task<Company> GetCompanyAsync(int id)
        {
            var response = await GetAsync<Company>($"/companies/{id}");
            return response.Data;
        }

        /// <summary>
        /// Create a new company
        /// </summary>
        /// <param name="request">Company creation request</param>
        /// <returns>Created company</returns>
        public async Task<Company> CreateCompanyAsync(CreateCompanyRequest request)
        {
            var response = await PostAsync<Company>("/companies", request);
            return response.Data;
        }

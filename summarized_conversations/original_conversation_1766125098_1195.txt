{'role': 'assistant', 'content': '\nNow let me create comprehensive unit tests for the ContactsClient class.\n\n<function_calls>\n<create-file file_path="LawMatics.SDK.Tests/Clients/ContactsClientTests.cs">\nusing System;\nusing System.Collections.Generic;\nusing System.Net;\nusing System.Net.Http;\nusing System.Text;\nusing System.Text.Json;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing LawMatics.SDK.Authentication;\nusing LawMatics.SDK.Configuration;\nusing LawMaticsSDK.Models;\nusing LawMaticsSDK.Exceptions;\nusing Microsoft.Extensions.Logging;\nusing Moq;\nusing Moq.Protected;\nusing Xunit;\n\nnamespace LawMatics.SDK.Tests.Clients\n{\n    /// <summary>\n    /// Unit tests for the <see cref="ContactsClient"/> class.\n    /// </summary>\n    public class ContactsClientTests : IDisposable\n    {\n        private readonly Mock<HttpMessageHandler> _mockHttpMessageHandler;\n        private readonly HttpClient _httpClient;\n        private readonly Mock<ILogger<LawMaticsClient>> _mockLogger;\n        private readonly LawMaticsClientOptions _options;\n        private readonly LawMaticsCredentials _credentials;\n        private readonly LawMaticsClient _lawMaticsClient;\n        private readonly ContactsClient _contactsClient;\n\n        public ContactsClientTests()\n        {\n            _mockHttpMessageHandler = new Mock<HttpMessageHandler>();\n            _httpClient = new HttpClient(_mockHttpMessageHandler.Object);\n            _mockLogger = new Mock<ILogger<LawMaticsClient>>();\n            _options = new LawMaticsClientOptions\n            {\n                BaseUrl = "https://api.test.lawmatics.com",\n                ApiVersion = "v1",\n                TimeoutSeconds = 30\n            };\n            _credentials = new LawMaticsCredentials("test-access-token");\n            _lawMaticsClient = new LawMaticsClient(_credentials, _httpClient, _options, _mockLogger.Object);\n            _contactsClient = new ContactsClient(_lawMaticsClient);\n        }\n\n        [Fact]\n        public async Task GetContactsAsync_WithoutParameters_ReturnsContactsList()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 1, FirstName = "John", LastName = "Doe", Email = "john.doe@example.com" },\n                    new Contact { Id = 2, FirstName = "Jane", LastName = "Smith", Email = "jane.smith@example.com" }\n                },\n                Pagination = new PaginationInfo\n                {\n                    CurrentPage = 1,\n                    PerPage = 10,\n                    Total = 2,\n                    TotalPages = 1,\n                    HasNext = false,\n                    HasPrev = false\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.GetContactsAsync();\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Equal(2, result.Data.Count);\n            Assert.Equal("John", result.Data[0].FirstName);\n            Assert.Equal("Doe", result.Data[0].LastName);\n            Assert.Equal("john.doe@example.com", result.Data[0].Email);\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Verify(\n                    "SendAsync",\n                    Times.Once(),\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts"),\n                    ItExpr.IsAny<CancellationToken>());\n        }\n\n        [Fact]\n        public async Task GetContactsAsync_WithPaginationParameters_ReturnsPaginatedContacts()\n        {\n            // Arrange\n            var parameters = new GetContactsParameters\n            {\n                Page = 2,\n                PerPage = 5,\n                SortBy = "first_name",\n                SortDirection = "asc"\n            };\n\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 6, FirstName = "Alice", LastName = "Johnson", Email = "alice.johnson@example.com" }\n                },\n                Pagination = new PaginationInfo\n                {\n                    CurrentPage = 2,\n                    PerPage = 5,\n                    Total = 25,\n                    TotalPages = 5,\n                    HasNext = true,\n                    HasPrev = true\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("page=2") == true &&\n                        req.RequestUri?.ToString().Contains("per_page=5") == true &&\n                        req.RequestUri?.ToString().Contains("sort_by=first_name") == true &&\n                        req.RequestUri?.ToString().Contains("sort_direction=asc") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.GetContactsAsync(parameters);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Single(result.Data);\n            Assert.Equal("Alice", result.Data[0].FirstName);\n            Assert.Equal(2, result.Pagination?.CurrentPage);\n            Assert.Equal(5, result.Pagination?.PerPage);\n        }\n\n        [Fact]\n        public async Task GetContactsAsync_WithFilterParameters_ReturnsFilteredContacts()\n        {\n            // Arrange\n            var parameters = new GetContactsParameters\n            {\n                FirstName = "John",\n                ContactType = "Client",\n                IsActive = true,\n                AssignedUserId = 123\n            };\n\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 1, FirstName = "John", LastName = "Doe", Email = "john.doe@example.com", ContactType = "Client", IsActive = true, AssignedUserId = 123 }\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("first_name=John") == true &&\n                        req.RequestUri?.ToString().Contains("contact_type=Client") == true &&\n                        req.RequestUri?.ToString().Contains("is_active=true") == true &&\n                        req.RequestUri?.ToString().Contains("assigned_user_id=123") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.GetContactsAsync(parameters);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Single(result.Data);\n            Assert.Equal("John", result.Data[0].FirstName);\n            Assert.Equal("Client", result.Data[0].ContactType);\n            Assert.True(result.Data[0].IsActive);\n            Assert.Equal(123, result.Data[0].AssignedUserId);\n        }\n\n        [Fact]\n        public async Task GetContactAsync_WithValidId_ReturnsContact()\n        {\n            // Arrange\n            var expectedContact = new Contact\n            {\n                Id = 1,\n                FirstName = "John",\n                LastName = "Doe",\n                Email = "john.doe@example.com",\n                Phone = "555-1234",\n                Company = "Test Corp"\n            };\n\n            var expectedResponse = new ApiResponse<Contact>\n            {\n                Data = expectedContact\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts/1"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.GetContactAsync(1);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.Equal(1, result.Id);\n            Assert.Equal("John", result.FirstName);\n            Assert.Equal("Doe", result.LastName);\n            Assert.Equal("john.doe@example.com", result.Email);\n            Assert.Equal("555-1234", result.Phone);\n            Assert.Equal("Test Corp", result.Company);\n        }\n\n        [Fact]\n        public async Task GetContactAsync_WithInvalidId_ThrowsArgumentException()\n        {\n            // Act & Assert\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.GetContactAsync(0));\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.GetContactAsync(-1));\n        }\n\n        [Fact]\n        public async Task GetContactAsync_WithNotFoundResponse_ThrowsLawMaticsNotFoundException()\n        {\n            // Arrange\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.NotFound);\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts/999"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act & Assert\n            var exception = await Assert.ThrowsAsync<LawMaticsNotFoundException>(() => _contactsClient.GetContactAsync(999));\n            Assert.Equal(404, exception.StatusCode);\n            Assert.Equal("Contact", exception.ResourceType);\n            Assert.Equal("999", exception.ResourceId);\n        }\n\n        [Fact]\n        public async Task CreateContactAsync_WithValidContact_ReturnsCreatedContact()\n        {\n            // Arrange\n            var createRequest = new CreateContactRequest\n            {\n                FirstName = "John",\n                LastName = "Doe",\n                Email = "john.doe@example.com",\n                Phone = "555-1234",\n                Company = "Test Corp"\n            };\n\n            var expectedContact = new Contact\n            {\n                Id = 1,\n                FirstName = "John",\n                LastName = "Doe",\n                Email = "john.doe@example.com",\n                Phone = "555-1234",\n                Company = "Test Corp"\n            };\n\n            var expectedResponse = new ApiResponse<Contact>\n            {\n                Data = expectedContact\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.Created)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Post && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.CreateContactAsync(createRequest);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.Equal(1, result.Id);\n            Assert.Equal("John", result.FirstName);\n            Assert.Equal("Doe", result.LastName);\n            Assert.Equal("john.doe@example.com", result.Email);\n            Assert.Equal("555-1234", result.Phone);\n            Assert.Equal("Test Corp", result.Company);\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Verify(\n                    "SendAsync",\n                    Times.Once(),\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Post && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts" &&\n                        req.Content != null),\n                    ItExpr.IsAny<CancellationToken>());\n        }\n\n        [Fact]\n        public async Task CreateContactAsync_WithNullContact_ThrowsArgumentNullException()\n        {\n            // Act & Assert\n            await Assert.ThrowsAsync<ArgumentNullException>(() => _contactsClient.CreateContactAsync(null!));\n        }\n\n        [Fact]\n        public async Task CreateContactAsync_WithEmptyContact_ThrowsArgumentException()\n        {\n            // Arrange\n            var emptyContact = new CreateContactRequest();\n\n            // Act & Assert\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.CreateContactAsync(emptyContact));\n        }\n\n        [Fact]\n        public async Task UpdateContactAsync_WithValidContact_ReturnsUpdatedContact()\n        {\n            // Arrange\n            var updateRequest = new CreateContactRequest\n            {\n                FirstName = "John Updated",\n                LastName = "Doe",\n                Email = "john.doe.updated@example.com"\n            };\n\n            var expectedContact = new Contact\n            {\n                Id = 1,\n                FirstName = "John Updated",\n                LastName = "Doe",\n                Email = "john.doe.updated@example.com"\n            };\n\n            var expectedResponse = new ApiResponse<Contact>\n            {\n                Data = expectedContact\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Put && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts/1"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.UpdateContactAsync(1, updateRequest);\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.Equal(1, result.Id);\n            Assert.Equal("John Updated", result.FirstName);\n            Assert.Equal("john.doe.updated@example.com", result.Email);\n        }\n\n        [Fact]\n        public async Task UpdateContactAsync_WithInvalidId_ThrowsArgumentException()\n        {\n            // Arrange\n            var updateRequest = new CreateContactRequest { FirstName = "Test" };\n\n            // Act & Assert\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.UpdateContactAsync(0, updateRequest));\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.UpdateContactAsync(-1, updateRequest));\n        }\n\n        [Fact]\n        public async Task DeleteContactAsync_WithValidId_ReturnsTrue()\n        {\n            // Arrange\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.NoContent);\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Delete && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts/1"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.DeleteContactAsync(1);\n\n            // Assert\n            Assert.True(result);\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Verify(\n                    "SendAsync",\n                    Times.Once(),\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Delete && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts/1"),\n                    ItExpr.IsAny<CancellationToken>());\n        }\n\n        [Fact]\n        public async Task DeleteContactAsync_WithInvalidId_ThrowsArgumentException()\n        {\n            // Act & Assert\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.DeleteContactAsync(0));\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.DeleteContactAsync(-1));\n        }\n\n        [Fact]\n        public async Task FindContactsByNameAsync_WithValidName_ReturnsContacts()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 1, FirstName = "John", LastName = "Doe", Email = "john.doe@example.com" }\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("contacts/find/name/John") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.FindContactsByNameAsync("John");\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Single(result.Data);\n            Assert.Equal("John", result.Data[0].FirstName);\n        }\n\n        [Fact]\n        public async Task FindContactsByNameAsync_WithEmptyName_ThrowsArgumentException()\n        {\n            // Act & Assert\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.FindContactsByNameAsync(""));\n            await Assert.ThrowsAsync<ArgumentException>(() => _contactsClient.FindContactsByNameAsync(null!));\n        }\n\n        [Fact]\n        public async Task FindContactsByEmailAsync_WithValidEmail_ReturnsContacts()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 1, FirstName = "John", LastName = "Doe", Email = "john.doe@example.com" }\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("contacts/find/email/john.doe%40example.com") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.FindContactsByEmailAsync("john.doe@example.com");\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Single(result.Data);\n            Assert.Equal("john.doe@example.com", result.Data[0].Email);\n        }\n\n        [Fact]\n        public async Task FindContactsByPhoneAsync_WithValidPhone_ReturnsContacts()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 1, FirstName = "John", LastName = "Doe", Phone = "555-1234" }\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("contacts/find/phone/555-1234") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.FindContactsByPhoneAsync("555-1234");\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Single(result.Data);\n            Assert.Equal("555-1234", result.Data[0].Phone);\n        }\n\n        [Fact]\n        public async Task FindContactsByCompanyAsync_WithValidCompany_ReturnsContacts()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<List<Contact>>\n            {\n                Data = new List<Contact>\n                {\n                    new Contact { Id = 1, FirstName = "John", LastName = "Doe", Company = "Test Corp" }\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("contacts/find/company/Test%20Corp") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.FindContactsByCompanyAsync("Test Corp");\n\n            // Assert\n            Assert.NotNull(result);\n            Assert.NotNull(result.Data);\n            Assert.Single(result.Data);\n            Assert.Equal("Test Corp", result.Data[0].Company);\n        }\n\n        [Fact]\n        public async Task GetContactsCountAsync_WithNoFilters_ReturnsCount()\n        {\n            // Arrange\n            var expectedResponse = new ApiResponse<Dictionary<string, object>>\n            {\n                Data = new Dictionary<string, object>\n                {\n                    ["count"] = 25\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString() == "https://api.test.lawmatics.com/v1/contacts/count"),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.GetContactsCountAsync();\n\n            // Assert\n            Assert.Equal(25, result);\n        }\n\n        [Fact]\n        public async Task GetContactsCountAsync_WithFilters_ReturnsFilteredCount()\n        {\n            // Arrange\n            var parameters = new GetContactsParameters\n            {\n                ContactType = "Client",\n                IsActive = true\n            };\n\n            var expectedResponse = new ApiResponse<Dictionary<string, object>>\n            {\n                Data = new Dictionary<string, object>\n                {\n                    ["count"] = 10\n                }\n            };\n\n            var responseJson = JsonSerializer.Serialize(expectedResponse);\n            var httpResponse = new HttpResponseMessage(HttpStatusCode.OK)\n            {\n                Content = new StringContent(responseJson, Encoding.UTF8, "application/json")\n            };\n\n            _mockHttpMessageHandler\n                .Protected()\n                .Setup<Task<HttpResponseMessage>>(\n                    "SendAsync",\n                    ItExpr.Is<HttpRequestMessage>(req => \n                        req.Method == HttpMethod.Get && \n                        req.RequestUri?.ToString().Contains("contact_type=Client") == true &&\n                        req.RequestUri?.ToString().Contains("is_active=true") == true),\n                    ItExpr.IsAny<CancellationToken>())\n                .ReturnsAsync(httpResponse);\n\n            // Act\n            var result = await _contactsClient.GetContactsCountAsync(parameters);\n\n            // Assert\n            Assert.Equal(10, result);\n        }\n\n        public void Dispose()\n        {\n            _httpClient?.Dispose();\n            _lawMaticsClient?.Dispose();\n        }\n    }\n}\n</create-file>\n</function_calls>'}